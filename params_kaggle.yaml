model:
  input_width: 1536
  input_height: 512 # IMG_HEIGHT = IMG_WIDTH // 16 * 5
  factor_downsample: 4
  num_classes: 8 # x,y,z, yaw, pitch_cos, pitch_sin, roll, confidence
  #path_weights: '../output/20200112_focal_loss_v2/model_6.pth' #'../output/20200110_img_larger_v3/model_7.pth'
  #path_weights: '../output/20200112_focal_loss/model_11.pth'
  path_weights: 'model.pth'
  flag_use_dummy_model: 0

datasets:
  flag_use_mask: 0
  train:
    path_csv: 'csv/train_train.csv'
    path_folder_images: '/kaggle/input/pku-autonomous-driving/train_images'
    path_folder_masks: '/kaggle/input/pku-autonomous-driving/train_masks'
  valid:
    path_csv: 'csv/train_valid.csv'
    path_folder_images: '/kaggle/input/pku-autonomous-driving/train_images'
    path_folder_masks: '/kaggle/input/pku-autonomous-driving/train_masks'
  test:
    path_csv: '/kaggle/input/pku-autonomous-driving/sample_submission.csv'
    path_folder_images: '/kaggle/input/pku-autonomous-driving/test_images'
    path_folder_masks: '/kaggle/input/pku-autonomous-driving/test_masks'


mode: 'train' # train or predict

train:
  use_augmentation: 0
  batch_size: 2
  batch_size_eval: 4
  num_epochs: 12
  learning_rate:
    initial: 0.002
    num_epochs_const: 3
    factor_decrease: 0.2
  loss:
    flag_focal_loss: 1
    flag_size_average: 1

predict:
  batch_size: 1
  num_batches_max: 99999999
  flag_optimize: 1 # modify x,y,z using predicted u,v and y(x,z) fit
  flag_plot_mat: 0
  flag_plot_item: 1

#path_folder_out: '../output/20200110_img_larger_v3/model_7'
path_folder_out: '20200112_focal_loss_v2/model_6'


